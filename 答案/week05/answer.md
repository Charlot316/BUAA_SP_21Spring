# Week05 Assignment 参考答案

## 1. 简述 shell 脚本中三个有特殊作用的字符

1. 管道 |

   管道可以将多个简单的命令连接起来，使一个命令的输出作为另外一个命令的输入，由此来实现更加复杂的功能。

2. 连接符 ；

   使用；连接符间隔的命令会按照先后次序依次执行。

3. 输入输出重定向 > <

   用来改变 Shell 获取信息和输出信息的方向。

4. `\` 转义
5. `$` 使用变量
6. `#` 注释

## 2. Shell 脚本的变量有哪几类，各是什么情况下使用？

- **环境变量**

定义和系统工作环境有关的变量，用户也可以重新定义该变量。常用于添加或修改环境变量。

- **用户定义变量**

用户定义的变量，可用于代替表达

- **内部变量（预定义变量）**

内部变量只能使用而不能修改或重定义，比如 `$#` 为传递给脚本参数的数量，`$$` 为当前进程的进程号，常用于作为暂存文件的名称，以保证不会重复。

| 内部变量 | 说明                                                                                               |
| :------: | -------------------------------------------------------------------------------------------------- |
|   `#`    | Shell 程序位置参数的个数                                                                           |
|   `*`    | 以 `IFS` 为分隔，脚本的所有位置参数内容                                                            |
|   `?`    | 上一条前台命令执行后返回的状态值，命令执行成功与失败返回值不同                                     |
|   `$`    | 当前 Shell 进程的进程 ID 号                                                                        |
|   `!`    | 最后一个后台运行命令的进程号                                                                       |
|   `0`    | 当前执行的 Shell 程序的名称                                                                        |
|   `@`    | 脚本的位置参数内容，从 1 开始，`$@` 被扩展为 `$1`、`$2` 等，分别表示第一个、第二个等的位置参数内容 |
|   `_`    | Shell 启动时，为正在执行的 Shell 程序的绝对路径；启动后，为上一条命令的最后一个参数                |

除此之外，常见的变量语法有参数置换变量，能根据不同条件给变量赋不同的值。常与位置参数变量结合使用。

- `变量=${parameter:-word}`：如果 `parameter` 未定义或为 `null`，则用 `word` 置换变量的值，否则用 `parameter` 置换变量的值。
- `变量=${parameter:=word}`：如果 `parameter` 未定义或为 `null`，则用 `word` 置换 `parameter` 的值然后置换变量的值，否则用 `parameter` 替换变量的值。
- `变量=${parameter:?word}`：如果 `parameter` 未定义或为 `null`，`word` 被写至标准出错（默认情况下在屏幕显示 `word` 信息）然后退出，否则用 `parameter` 置换变量的值。
- `变量=${parameter:+word}`：如果 `parameter` 未定义或为 `null`，则不进行替换，即变量值也为 `null`，否则用 `word` 置换变量的值。

## 3. Shell 脚本分支语句有几类，各是什么情况下使用？

1. if 语句

   Shell 中的 if 条件语句分为：单分支 if 语句、双分支 if 语句进而多分支 if 语句，其结构大体与其他程序设计语言的条件语句相同。

2. select 语句

   Shell 中的 select 语句可以将选项列表做出类似目录的形式，以交互的形式选择列表中的数据，传入 select 语句中的主体部分加以执行。

3. case 语句

   case 语句可以将一个变量的内容与多个选项进行匹配，若匹配成功，则执行该条件下对应的语句。

## 4. Shell 脚本循环语句有几类，各是什么情况下使用？

1. for 循环

   对一个集合中的对象进行循环，并进行相应操作。

2. while 循环

   while 循环在表达式的值为假时停止循环，否则循环一直进行。

3. until 循环

   与 while 循环的格式基本相同，不过 until 循环是在表达式值为真时停止循环，否则循环一直进行。

## 5. 简述 shell 脚本的调试方法

1. 使用大量 echo 语句来打印显示程序内部执行情况。
2. 用 trap 命令捕获程序退出的信号并执行相应的动作，格式为 trap 操作 信号名。
3. sh 命令：`sh` 命令可以执行 Shell 程序，在使用它时，通过使用参数可以查看每条命令的执行情况。
   | sh 的参数 | 说明 |
   | :-: | - |
   | `-n` | 检测语法错误，但无法检查出所有错误 |
   | `-v` | 执行每一条命令前，显示该命令 |
   | `-x` | 打印每条命令的结果 |
4. tee: `tee` 会将输入分到 stdout 和输出文件中去，这个特性可以帮助为管道命令
5. 调试钩子：本质就是用`if`语句来包裹调试信息，到了交付的时候设置`DEBUG`变量为`false`即可。
